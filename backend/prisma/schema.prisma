generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  senha     String
  nome      String
  tipo      String   // "admin" | "profissional" | "paciente"
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Provincia {
  id        Int        @id @default(autoincrement())
  nome      String
  municipios Municipio[]
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

model Municipio {
  id          Int           @id @default(autoincrement())
  nome        String
  provinciaId Int
  provincia   Provincia     @relation(fields: [provinciaId], references: [id])
  centros     CentroSaude[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

model CentroSaude {
  id          Int           @id @default(autoincrement())
  nome        String
  endereco    String
  municipioId Int
  municipio   Municipio     @relation(fields: [municipioId], references: [id])
  servicos    Servico[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

model Servico {
  id            Int             @id @default(autoincrement())
  nome          String
  descricao     String
  duracao       Int            // duração em minutos
  centroId      Int
  centro        CentroSaude     @relation(fields: [centroId], references: [id])
  profissionais Profissional[]
  agendamentos  Agendamento[]
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
}

model Profissional {
  id          Int           @id @default(autoincrement())
  nome        String
  especialidade String
  servicos    Servico[]
  agendamentos Agendamento[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

model Paciente {
  id          Int           @id @default(autoincrement())
  nome        String
  dataNascimento DateTime
  telefone    String
  endereco    String
  agendamentos Agendamento[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

model Agendamento {
  id            Int         @id @default(autoincrement())
  data          DateTime
  status        String      // "agendado" | "confirmado" | "cancelado" | "realizado"
  servicoId     Int
  servico       Servico     @relation(fields: [servicoId], references: [id])
  profissionalId Int
  profissional  Profissional @relation(fields: [profissionalId], references: [id])
  pacienteId    Int
  paciente      Paciente    @relation(fields: [pacienteId], references: [id])
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
} 